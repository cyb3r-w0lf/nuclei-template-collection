id: CVE-2023-3452

info:
  name: Unauthenticated RCE via RFI - Remote File Inclusion - Wordpress Plugin Canto < 3.0.5
  author: kathuluman
  severity: critical
  description: |
    Wordpress plugin Canto < 3.0.5 is vulnerable to Remote File Inclusion which can lead to Remote Code execution.
  reference:
    - https://github.com/leoanggal1/CVE-2023-3452-PoC
    - https://www.exploit-db.com/exploits/51826
    - https://patchstack.com/database/vulnerability/canto/wordpress-canto-plugin-3-0-6-unauthenticated-remote-code-execution-rce-vulnerability
    - https://nvd.nist.gov/vuln/detail/CVE-2024-25096
    - https://wpscan.com/vulnerability/9e2817c7-d4aa-4ed9-a3d7-18f3117ed810/
  metadata:
    verified: true
    max-request: 2
    publicwww-query: "/wp-content/plugins/canto/"
    fofa-query: 'body="/wp-content/plugins/canto/"'
  tags: cve,cve2023,wpscan,wordpress,wp-plugin,wp,canto,rce.rfi

requests:
  - raw:
      - |
        GET /wp-content/plugins/canto/package.json HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - '"version"\s*:\s*"([^"]+)"'
        condition: and

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - '"version"\s*:\s*"([^"]+)"'
        internal: true

  - raw:
      - "3.0.5"
      - "3.0.4"
      - "3.0.3"
      - "3.0.2"
      - "3.0.1"
      - "3.0.0"

    matchers-condition: and
    matchers:
      - type: word
        part: version
        words:
          - "3.0.5"
          - "3.0.4"
          - "3.0.3"
          - "3.0.2"
          - "3.0.1"
          - "3.0.0"
        condition: and
